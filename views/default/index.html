{{extend 'layout.html'}}

{{block head}}
<script src="{{=URL('static', 'js/vue.min.js')}}"></script>
<script>


    var get_announcements_url = "{{=URL('api', 'get_announcements')}}";
    var add_announcement_url = "{{=URL('api', 'add_announcement', user_signature=True)}}";

    var get_my_announcements_url = "{{=URL('api', 'get_my_announcements')}}";
    var get_only_urgent_url = "{{=URL('api', 'get_only_urgent')}}";
    var get_only_event_url = "{{=URL('api', 'get_only_event')}}";
    var get_only_shutdown_url = "{{=URL('api', 'get_only_shutdown')}}";

</script>

{{end}}

<script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
<script src="{{=URL('static', 'js/leaflet.awesome-markers.js')}}"></script>
<script src="{{=URL('static', 'js/ourmap.js')}}"></script>
<script src="{{=URL('static', 'js/announcement.js')}}"></script>
<script src="{{=URL('static', 'js/ourmap.js')}}"></script>
<script src="{{=URL('static', 'js/leaflet.awesome-markers.js')}}"></script>


<div class="main_content">

    <div id="mapid" >
        <script>
            //this re-sizes the window automattically. Just change the numbers after height and width.
            //If you want to reserve part of the screen for a menu, like the vertical menu we have on the left,
            //You have to change the padding in the css file.

        $(window).on("resize", function() {
            $("#mapid").height($(window).height() * 1.00).width($(window).width() * 0.50);
            //New_Map.map.invalidateSize();
        }).trigger("resize");
        </script>
    </div>




    <!-------------- Left Navigation Bar --------------------->


    <div id="vue-div" class="display:none">
        <nav class="vertical_menu navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <ul class="nav navbar-nav">
                 <li class="dropdown" data-w2pmenulevel="l0">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">search</a>
                 </li>
              <li class="dropdown" data-w2pmenulevel="l0">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                  <ul class="dropdown-menu">
                    <li><a v-on:click="change_view('crown')" class="menu_links">Crown</a></li>
                    <li><a v-on:click="change_view('merrill')" class="menu_links">Merrill</a></li>
                    <li><a v-on:click="change_view('rachael_carson')" class="menu_links">Rachael Carson</a></li>
                    <li><a v-on:click="change_view('college_9')" class="menu_links">College 9</a></li>
                    <li><a v-on:click="change_view('college_10')"class="menu_links">College 10</a></li>
                    <li><a v-on:click="change_view('porter')"class="menu_links">Porter</a></li>
                    <li><a v-on:click="change_view('kresge')" class="menu_links">Kresge</a></li>
                    <li><a v-on:click="change_view('cowell')" class="menu_links">Cowell</a></li>
                    <li><a v-on:click="change_view('stevenson')" class="menu_links">Stevenson</a></li>
                    <li><a v-on:click="change_view('oakes')" class="menu_links">Oakes</a></li>
                  </ul>
              </li>

            <li class="dropdown" data-w2pmenulevel="l0">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Filter</a>
                  <ul class="dropdown-menu">
                    <li><a v-if="'{{=auth.user_id}}' > 0" v-on:click="get_my_announcements()"> Show my announcements </a></li>
                    <li><a v-on:click="show_every_announcement()" class="menu_links">All Announcements </a></li>
                    <li><a v-on:click="get_urgent_announcements()" class="menu_links">Show only Urgent</a></li>
                    <li><a v-on:click="get_event_announcements()" class="menu_links">Show only Event</a></li>
                    <li><a v-on:click="get_shutdown_announcements()" class="menu_links">Show only Shutdown</a></li>
                  </ul>
              </li>

          </ul>



        <button class="btn btn-warning btn-sm"
            v-on:click="re_populate_map()">
            re-populate map
        </button>


<script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js"></script>

          <div class="filter-form-wrapper">
              <button v-on:click="toggle_filter_show()" class="filter-dropdown-toggle">Filter</button>


              <ul v-if="filter_form.show" class="filter-list" v-transition>

                <li><p>name <input type="checkbox" v-model="filter_form.name"></p></li>
                <li><p>age <input type="checkbox" v-model="filter_form.age"></p></li>
                <li>
                    Category
            <!-- radio buttons -->
                <ul>
                    <li>
                        <input  type="radio" name="category" value="urgent" v-model="filter_form.category">
                        urgent
                    </li>
                    <li>
                        <input  type="radio" name="category" value="event" v-model="filter_form.category">
                        event
                    </li>
                    <li>
                      <input  type="radio" name="category" value="shutdown" v-model="filter_form.category">
                        shut down
                    </li>
                </ul>
                </li>
                <li>
                    <button class="btn btn-warning btn-sm"
                        v-on:click="filter_submit_button()">
                        submit filter
                    </button>
                </li>

              </ul>

        </div>


        </div>
        </nav>

        <!---- Right Nav Bar ----->
        <nav class="right_menu navbar navbar-default" role="navigation">
          <div class="container-fluid">

            <div class="navbar-header navbar-brand"> Public Service Announcement </div>

            <div  class="collapse navbar-collapse navbar-ex1-collapse">
                 <p class="collapse navbar-collapse navbar-ex1-collapse">
                     <ul class="nav navbar-nav">
                        {{='auth' in globals() and auth.navbar('Welcome',mode='dropdown') or ''}}
                     </ul>
                </p>

                <div v-if="'{{=auth.user_id}}' > 0" class="logged-in-left-user-tools">
                <ul class="nav navbar-nav">
                   <!--- <li class="web2py-menu-first"><a href="/project/default/index">Home</a></li> --->
<!--                   <li v-if="logged_in" class="dropdown" data-w2pmenulevel="l0">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            Create Event
                      </a>
                      <ul class="dropdown-menu">
                          <li>
                              <a v-on:click="set_next_announcement('urgent')" id="set_announcement_urgent" class="menu_links">
                                Urgent
                              </a>
                          </li>
                          <li><a v-on:click="set_next_announcement('event')" id="set_announcement_event" class="menu_links">
                              Event
                          </a></li>
                          <li><a v-on:click="set_next_announcement('shutdown')" id="set_announcement_shutdown" class="menu_links">
                              Shut Down
                          </a></li>
                      </ul>
                  </li>
               </ul>
-->
                <!-- create announcement buttons -->
                <div class="button-bar-create-announcement">
                    <button v-if="!isCreatingAnnouncement" class="btn btn-danger btn-sm"
                            v-on:click="create_announcement_button()" >
                            <!-- v-bind:class="{'disabled': !logged_in}"-->
                        Create Announcement
                    </button>

                    <button v-if="isCreatingAnnouncement" class="btn btn-warning btn-sm"
                            v-on:click="cancel_announcement_button()">
                        Cancel
                    </button>
                </div>

                <!-- create announcement Form -->
                <div class="create-announcement-wrapper" v-if="isCreatingAnnouncement" >
                <form id="create_announcement_form"
                      action="#"
                      v-on:submit.prevent="add_announcement"
                      enctype="multipart/form-data"
                      method="post">
                    <!-- text -->
                    <p>
                        Title
                        <input type="text" v-model="announcement_form.name">
                    </p>
                    <p>
                        Description
                        <input type="text" v-model="announcement_form.description">
                    </p>

            <!-- radio buttons -->
                <ul>
                    <li>
                        <input v-on:click="update_marker('urgent')" type="radio" name="category" value="Urgent" v-model="announcement_form.category">
                        urgent
                    </li>
                    <li>
                        <input v-on:click="update_marker('event')" type="radio" name="category" value="Event" v-model="announcement_form.category">
                        event
                    </li>
                    <li>
                      <input v-on:click="update_marker('shutdown')" type="radio" name="category" value="Shut Down" v-model="announcement_form.category">
                        shut down
                    </li>
                    <li>
                      ${announcement_form.category}
                    </li>
                </ul>

                <!-- submit button -->
               <button
                    class="btn btn-primary"
                           id="add_announcement_submit"
                            v-on:click="add_announcement()" >
                    Submit
                </button>

                </form></div>

            </div>
            </div>
          </div>
        </nav>


        <!--
        <div v-if="announcement_form.active" id="create_new_announcement" class="new_announcement_wrapper" >
            <form >

            <h3>Announcement Name</h3>
            <div class="form-group" id="no_table_name__row">
                <div>
                    <input class="form-control string"  id="no_table_name"  v-model="announcement_form.name" placeholder="announcement name" type="text" />
                    <span class="help-block"></span>
                </div>
            </div>

            <h3>Announcement Description</h3>
            <div class="form-group" id="no_table_description__row">
                <div>
                    <input class="form-control string" id="no_table_description" v-model="announcement_form.description" placeholder="description" type="text" />
                    <span class="help-block"></span>
                </div>
            </div>


            <div class="form-group" id="submit_announcement_row">
                <button
                    class="btn btn-primary"
                           id="add_announcement_submit"
                            v-on:click="add_announcement()" >
                    Submit
                </button>

                 <button  class="btn btn-warning btn-sm" v-on:click="cancel_announcement_button()">
                    Cancel
                </button>
            </div>

            </form>
        </div>
        -->

        <div class="history">
          <div v-if="show_all_announcements == true">
               <div class="ann" v-for="(name,index) in names" v-on:click="view_announcement(coordinates[index])">
                 Title: ${names[index]} <br>
                 Description: ${description[index]} <br>
                 Category: ${category[index]}
                 <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                 <i class="fa fa-thumbs-down" aria-hidden="true"></i>
               </div>
          </div>
          <div v-if="show_my_announcements == true">
              <div class="ann" v-for="ann in my_announcements" v-on:click="">
                 Title: ${ann.name} <br>
                 Description: ${ann.description} <br>
                 Category: ${ann.category} <br>
                 <i class="fa fa-trash-o"></i>
                 <i class="fa fa-pencil"></i>
              </div>
          </div>
          <div v-if="show_only_urgent == true">
              <div class="ann" v-for="ann in urgent_announcements" v-on:click="">
                 Title: ${ann.name} <br>
                 Description: ${ann.description} <br>
                 Category: ${ann.category} <br>
              </div>
          </div>
          <div v-if="show_only_shutdown == true">
              <div class="ann" v-for="ann in shutdown_announcements" v-on:click="">
                 Title: ${ann.name} <br>
                 Description: ${ann.description} <br>
                 Category: ${ann.category} <br>
              </div>
          </div>
          <div v-if="show_only_event == true">
              <div class="ann" v-for="ann in event_announcements" v-on:click="">
                 Title: ${ann.name} <br>
                 Description: ${ann.description} <br>
                 Category: ${ann.category} <br>
              </div>
          </div>
        </div>


    </div> <!-- end vue-div -->

            <!-- here is the campus map     -->
</div> <!-- end main-content -->


<script src="{{=URL('static', 'js/default_index.js')}}">    </script>